{
  "secret": "{{ freefeed_secret }}",
  "origin": "*",
  "serviceName": "FreeFeed",
{% if monitor_prefix is defined %}
  "monitorPrefix": "{{ monitor_prefix }}",
{% endif %}
  "trustProxyHeaders": true,
{% if recaptcha_server_secret is defined %}
  "recaptcha": {
    "enabled": true,
    "secret": "{{ recaptcha_server_secret }}"
  },
{% endif %}
  "application": {
    "extraStopListPath": "/etc/freefeed/banlist.txt"
  },
  "company": {
    "title": "{{ company_title }}",
    "address": "{{ company_address }}"
  },
  "sentryDsn": "{{ sentry_dsn | default(None) }}",
  "host": "https://{{ freefeed_hostname }}",
  "media": {
    "url": "https://{{ freefeed_media_hostname }}/",
    "storage": {
      "type": "{{ freefeed_storage_type }}",
      "rootDir": "{{ freefeed_files_root_dir | default('/var/freefeed-files') }}",
      "accessKeyId": "{{ aws_access_key | default(None) }}",
      "secretAccessKey": "{{ aws_secret_key | default(None) }}",
      "bucket": "{{ freefeed_s3_bucket | default(None) }}"
    }
  },
  "attachments": {
    "fileSizeLimit": 52428800
  },
  "profilePictures": {
    "defaultProfilePictureMediumUrl": "https://media.freefeed.net/attachments/d067713e-0ba4-4d0a-ae1f-41b31780fda3.png"
  },
  "mailer": {
    "useSMTPTransport": true,
    "fromName": "{{ freefeed_mailer_from_name }}",
    "fromEmail": "{{ freefeed_mailer_from_email }}",
    "resetPasswordMailSubject": "{{ freefeed_site_title }} password reset",
    "options": {
      "host": "{{ freefeed_mailer_smtp_host }}",
      "port": {{ freefeed_mailer_smtp_port }},
      "secure": {{ freefeed_mailer_use_tls | default(False) }},
      "auth": {
        "user": "{{ freefeed_mailer_smtp_user }}",
        "pass": "{{ freefeed_mailer_smtp_pass }}"
      }
    },
    "adminRecipient": {
      "email": "archives@freefeed.net",
      "screenName": "Archive admins"
    }
  },
  "redis": {
    "host": "{{ redis_host | default('localhost') }}",
    "port": "{{ redis_port | default(6379) }}"
  },
  "postgres": {
    "connection": {
      "host": "{{ postgres_host }}",
      "database": "{{ postgres_dbname }}",
      "user": "{{ postgres_user }}",
      "password": "{{ postgres_pass }}"
    },
{% if postgres_textsearch_config is defined %}
    "textSearchConfigName": "{{ postgres_textsearch_config }}",
{% endif %}
    "pool": {
      "idleTimeoutMillis": 3600000
    }
  },
  "performance": {
    "searchQueriesTimeout": 45000
  },
  "externalAuthProviders": [
{% set comma = joiner(",") %}
{% if freefeed_external_auth_google_client_id is defined %}
    {{ comma() }}
    {
      "template": "google",
      "params": {
        "clientId": "{{ freefeed_external_auth_google_client_id }}",
        "clientSecret": "{{ freefeed_external_auth_google_client_secret }}"
      }
    }
{% endif %}
{% if freefeed_external_auth_facebook_client_id is defined %}
    {{ comma() }}
    {
      "template": "facebook",
      "params": {
        "clientId": "{{ freefeed_external_auth_facebook_client_id }}",
        "clientSecret": "{{ freefeed_external_auth_facebook_client_secret }}"
      }
    }
{% endif %}
  ],
{% if new_relic_app_name is defined %}
  "app_name": "{{ new_relic_app_name }}",
  "license_key": "{{ new_relic_license_key }}",
{% endif %}
  "eof": true
}
